import json
import discord
import distributioner
from datetime import timedelta
from datetime import datetime

async def value_below_zero(ctx, value):
    if value <= 0:
        embed = discord.Embed(
            title="Cringe",
            description= ctx.author.mention + " tries to spawn money he will be timeouted for 5 minutes!",
            color=discord.Colour.dark_red()
        )
        guild = discord.Client.get_guild(discord.Bot, 908337305759141948)
    
        this_member = guild.get_member(ctx.author.id)

        await this_member.timeout(until=(datetime.now() + timedelta(minutes=5)), reason="cringe bro was willsh eif geld spawne!")
        
        ctx.respond(embed=embed)
        return False
    else:
        return True

async def check_lenillian(ctx):
    if ctx.author.id == 646782364676128781:
        return True
    else:
        embed = discord.Embed(
            title="401 Unauthorized",
            description=ctx.author.mention + " you are not allowed to use owner command!",
            color=discord.Colour.dark_red()
        ) 
        
        await ctx.respond(embed=embed)
        return False
        

async def check_value(ctx, key_value, value):
    if key_value - value < 0:
        
        embed = discord.Embed(
            title="500 Internal Server Error",
            description= "Just kidding " + ctx.author.mention + " you are just too broke...",
            color=discord.Colour.dark_red()
        )   
        await ctx.respond(embed=embed)
        return False
    else:
        return True
    
async def is_user_in_db(author_id):
    with open('data.json') as json_file:
        data = json.load(json_file)
        
        server = data['server']

        users = server['users']
        check = False
        for user in users:
            if user['user'] == author_id:
                check = True
            
    return check
    
async def check_user(ctx, ctx_author):
    with open('data.json') as json_file:
        data = json.load(json_file)
        
        server = data['server']

        users = server['users']
        check = False
        for user in users:
            if user['user'] == ctx_author.id:
                check = True
                
        if check == False:
            embed = discord.Embed(
                title="418 I'm a teapot",
                description= "Just kidding " + ctx_author.mention + " use /login first to get a Job...",
                color=discord.Colour.dark_red()
            )
            
            await ctx.respond(embed=embed)
            
    return check